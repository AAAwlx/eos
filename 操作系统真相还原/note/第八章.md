# 实现断言
## 什么是断言
断言（Assertion）是一种在程序中插入的一种声明，用于指定程序在运行到此处时某个条件应该为真。断言通常用于检查程序的内部状态是否符合预期，以确保程序的正确性。如果断言的条件不为真，系统就会触发一个断言失败，通常伴随着相关信息的输出，帮助程序员识别问题的根本原因。\
在C语言中，通常使用assert宏来实现断言。其基本形式如下：\

```c
#include <assert.h>

int main() {
    int x = 5;
    
    assert(x == 5);

    // Rest of the program

    return 0;
}
```
在这个例子中，assert(x == 5); 断言 x 的值应该为 5。如果这个条件不成立，assert 宏会触发一个断言失败，并输出一条包含相关信息的错误消息。在发布版本的程序中，通常会关闭断言，以避免在生产环境中触发不必要的错误。\
## 如何实现断言
观察断言的形式我们可以联想到使用宏来实现。\
先定义宏ASSTRE，它需要一个参数，该参数是判断的是否调用中断的依据。
```c
#ifdef NDEBUG
    #define ASSERT(CONDITION)((void)0) 
#else
    #define ASSERT(CONDITION)\
    if(CONDITION){              \
                                \
    }else{                      \
        PANIC_SPIN(#CONDITION); \
    }                           
#endif
```
如果不需要宏的时候将宏的内容定义为空，减小程序的体积在宏。#将PANIC_SPIN中的CONDITION转换为字符串
```c
#define PANIC_SPIN(...)(__FILE__, __LINE__, __func__, __VA_ARGS__) 
```
__FILE__ __LINE__ __func__\
这三者是编译器预定义的宏，分别代表文件名，行数,函数名。
__VA_ARGS__与前面的...配合表示变长参数。
在函数panic_spin中，将开启中断
```c
void panic_spin(char* file, int line, char* func, char* condition);
```
当使用PANIC_SPIN宏时，它会将当前文件名、行号、函数名以及传递给宏的其他参数传递给panic_spin函数，函数中执行打印函数将错误信息打印出来，并进入死循环使程序悬停在此处。
# 实现字符串库
# 位图
在管理内存时，用bitmap来表示操作系统中的


